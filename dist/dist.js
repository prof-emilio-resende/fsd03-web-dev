(()=>{"use strict";class t{constructor(){this.componentName=this.__proto__.constructor.name,console.log(`Inicializando um novo componente ${this.componentName}...`),this.element=document.querySelector(this.componentName),this.state={}}onLoad(){console.log("no implementation for onLoad..."),this.paint()}observe(t){console.log(`observing obj [${t}]`);const e=this;return t?new Proxy(t,{set(t,o,s,n){const i=Reflect.set(t,o,s);return console.log(`updated ... ${i}`),t.isValid()?(console.log("target is valid, sync state..."),console.log(e),console.log(t),e.setObserveReady(t),!0):(console.log("target still invalid, skipping state update..."),!0)}}):t}setObserveReady(t){throw new Error(`No observeReady implementation provided for ${this.componentName}`)}render(){throw new Error(`No implementation provided to view component ${this.componentName}`)}paint(){this.element.innerHTML=this.render()}setState(t){this.state=t,this.paint()}}class e{get(t,e){return fetch(`${t}${e}`)}post(t,e,o){const s={method:"post",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify(o)};return fetch(`${t}${e}`,s)}}class o{constructor(){this.xhr=new e}handleRestResponse(t){return t.json()}getTableData(){return this.xhr.get("http://localhost:8080","/imc/table").then(this.handleRestResponse)}calculate(t){return this.xhr.post("http://localhost:8080","/imc/calculate",t.toObject()).then(this.handleRestResponse)}}class s{constructor(){this.imcDriver=new o}loadTable(t){this.imcDriver.getTableData().then(t)}calculate(t,e){this.imcDriver.calculate(t).then(e)}}class n{constructor(t,e){this._height=t,this._weight=e,this.imc=0,this.imcDescription=""}get height(){return this._height}set height(t){console.log("setting height value..."),this._height=t}get weight(){return this._weight}set weight(t){console.log("setting weight value..."),this._weight=t}isValid(){return this._height&&this._weight}toObject(){return{height:this._height,weight:this._weight,imc:this.imc,imcDescription:this.imcDescription}}}const i=new class extends t{constructor(){super(),this.imcController=new s}onLoad(){this.imcController.loadTable((t=>this.setState({range:t})))}render(){return this.state.range?`<table>\n        ${Object.keys(this.state.range).sort().map((t=>`<tr>\n                  <td>${t}</td>\n                  <td>${this.state.range[t]}</td>\n              </tr>`)).join("")}\n      </table>`:"<table></table>"}},r=new class extends t{constructor(){super(),this.imcController=new s,this.state=new n(0,0)}render(){const t=this.state;return`Seu IMC Ã© <span>${t.imc}</span> : <strong>${t.imcDescription}</strong>`}setObserveReady(t){console.log("setObserverReady called..."),this.imcController.calculate(t,(t=>this.setState(t)))}};window.onload=function(){document.querySelector(".data .form button").addEventListener("click",function(){const t=document.querySelector("#altura"),e=document.querySelector("#peso");if(!t)throw Error("height is required field!");if(!e)throw Error("weight is required field!");const o=r.observe(r.state);return function(){console.log("calculando..."),o.height=t.value,o.weight=e.value}}()),i.onLoad(),r.onLoad()}})();